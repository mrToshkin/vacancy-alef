"use strict";for(var CATS_AMOUNT=17,MONTH_IN_YEAR=12,data=[],randomInteger=function(e,t){return Math.floor(e+Math.random()*(t+1-e))},randomSale=function(){return 1===randomInteger(0,1)&&"-".concat(10*randomInteger(1,5),"%")},mock=function(e){return{id:e,name:"Кот полосатый",photoJpg:"img/content/cat__".concat(randomInteger(1,3),".jpg"),photoWebp:"img/content/cat__".concat(randomInteger(1,3),".webp"),price:1e3*randomInteger(10,40),age:randomInteger(1,100),color:"Коричневый окрас",paws:4,favorite:1===randomInteger(0,1),soldOut:1===randomInteger(0,1),sale:randomSale()}},i=0;i<CATS_AMOUNT;i++)data.push(mock(i));var $price=$(".sort__price"),$priceDir=$(".sort__price-direction"),priceUp="sort__price-direction--up",$age=$(".sort__age"),$ageDir=$(".sort__age-direction"),ageUp="sort__age-direction--up",sortCard=function(e,t,o){e.hasClass(t)?insertCards(data.sort((function(e,t){return t[o]-e[o]}))):insertCards(data.sort((function(e,t){return e[o]-t[o]})))};$price.on("click",(function(){return sortCard($priceDir,priceUp,"price")})),$priceDir.on("click",(function(){$priceDir.toggleClass(priceUp),sortCard($priceDir,priceUp,"price")})),$age.on("click",(function(){return sortCard($ageDir,ageUp,"age")})),$ageDir.on("click",(function(){$ageDir.toggleClass(ageUp),sortCard($ageDir,ageUp,"age")}));var CARDS_SHOW_AMOUNT=6,lastIndex=null,addsCount=2,cardTemplate=document.querySelector("#card").content.querySelector(".card"),$perent=$(".result__body"),$showButton=document.querySelector(".result__button-show-more"),prettify=function(e){return e.toString().replace(/(\d{1,3}(?=(?:\d\d\d)+(?!\d)))/g,"$1 ")},createCard=function(e){var t=cardTemplate.cloneNode(!0);return t.id=e.id,t.querySelector("h4").textContent=e.name,t.querySelector("img").src=e.photoJpg,t.querySelector("source").src=e.photoWebp,t.querySelector(".card__price").textContent="".concat(prettify(e.price)," руб."),e.age<=11?t.querySelector("#age").textContent="".concat(e.age," мес."):t.querySelector("#age").textContent="".concat(Math.floor(e.age/MONTH_IN_YEAR)," лет"),t.querySelector(".card__info-color").textContent=e.color,t.querySelector("#paws").textContent=e.paws,e.favorite&&t.querySelector(".card__button-favorite").classList.add("card__button-favorite--selected"),t.querySelector(".card__button-favorite").addEventListener("click",onFavoriteClick),e.soldOut?(t.querySelector(".card__button-buy").textContent="Купить",t.querySelector(".card__button-buy").href="#"):(t.querySelector(".card__button-buy").classList.add("card__button-buy--sold-out"),t.querySelector(".card__button-buy").textContent="Продан"),e.sale?t.querySelector(".card__sale").textContent=e.sale:t.querySelector(".card__sale").classList.add("hidden"),t};function insertCards(e){$perent.empty(),e.forEach((function(e,t){t<CARDS_SHOW_AMOUNT&&($perent.append(createCard(e)),lastIndex=t,addsCount=2)})),e.length>=CARDS_SHOW_AMOUNT?($showButton.classList.remove("hidden"),$showButton.removeEventListener("click",onShowMoreClick),$showButton.addEventListener("click",onShowMoreClick)):$showButton.classList.add("hidden")}function addCards(e){var t=!1;e.forEach((function(o,n){!t&&n>lastIndex&&n<CARDS_SHOW_AMOUNT*addsCount&&($perent.append(createCard(o)),lastIndex=n),t||n!==CARDS_SHOW_AMOUNT*addsCount||(addsCount++,t=!0),CARDS_SHOW_AMOUNT*addsCount>=e.length&&lastIndex+1>=e.length&&($showButton.removeEventListener("click",onShowMoreClick),$showButton.classList.add("hidden"))}))}function onShowMoreClick(){if(lastIndex+1<data.length){var e=window.pageYOffset;addCards(data),window.scrollTo(window.pageXOffset,e)}else $showButton.removeEventListener("click",onShowMoreClick),$showButton.classList.add("hidden")}insertCards(data),$("#cats-amount").text(data.length),$("#show-more-text").text(CARDS_SHOW_AMOUNT);var $notification=$("#notification").contents(".notification");function onFavoriteClick(e){var t=e.currentTarget,o="card__button-favorite--selected";$("body").append($notification),$notification.stop().fadeIn(500,(function(){$notification.delay(1500).fadeOut(500)})),$(this).hasClass(o)?(t.classList.remove(o),$("#notification__text").text("Кот удалён из избранного")):(t.classList.add(o),$("#notification__text").text("Кот добавлен в избранное"))}$((function(){$("form").each((function(){$(this).on("submit",(function(){if($(this).validate({rules:{email:{required:!0,email:!0},subscribe:"required"},messages:{email:{required:"Введите email",email:"Email должен быть в формате name@domain.com"},subscribe:"Подпишитесь на наши новости"}}),$(this).valid()){var e=$(this)[0].closest(".subscribe-block__form");e&&($(e).siblings(".subscribe-block__form-accepted").show(),$(e).hide())}return!1}))}))})),$((function(){var e=document.querySelector("body"),t=document.querySelector(".burger"),o=document.querySelector(".mobile-menu__overlay"),n=window.matchMedia("(max-width: 768px)");$("body").removeClass("nojs"),n.addListener((function(e){e.matches?$("body").addClass("menu--closed"):($("body").removeClass("menu--closed"),$("body").removeClass("menu--opened"),$(".mobile-menu__overlay").removeClass("mobile-menu__overlay--opened"))})),n.matches&&$("body").addClass("menu--closed"),$(".burger").on("click",(function(e){e.preventDefault,$(this).toggleClass("burger--opened"),$(".mobile-menu__overlay").toggleClass("mobile-menu__overlay--opened")})),t.addEventListener("click",(function(){e.classList.contains("menu--closed")?(e.classList.remove("menu--closed"),e.classList.add("menu--opened"),t.setAttribute("aria-expanded",!0)):(e.classList.add("menu--closed"),e.classList.remove("menu--opened"),t.setAttribute("aria-expanded",!1))})),o.addEventListener("click",(function(){e.classList.add("menu--closed"),e.classList.remove("menu--opened"),t.classList.remove("burger--opened"),o.classList.remove("mobile-menu__overlay--opened")}))})),$((function(){var e=$(".result__button-go-up");function t(){document.body.offsetHeight>window.innerHeight?(e.show(),e.on("click",(function(e){$("html,body").stop().animate({scrollTop:$("#result").offset().top},200),e.preventDefault()}))):(e.hide(),e.off("click"))}window.addEventListener("resize",t),t()}));